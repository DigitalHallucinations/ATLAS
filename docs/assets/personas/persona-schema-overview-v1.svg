<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="620" viewBox="0 0 1000 620" role="img" aria-labelledby="title desc">
  <title id="title">ATLAS persona schema overview</title>
  <desc id="desc">Diagram showing persona document requirements, persona entry fields, tool and skill allowlists, personal assistant toggles, and collaboration participant validation.</desc>
  <style>
    .box { fill: #f7f9ff; stroke: #4b6cb7; stroke-width: 2; rx: 6; ry: 6; }
    .subbox { fill: #ffffff; stroke: #7a8ba8; stroke-width: 1.5; rx: 6; ry: 6; }
    .title { font: 700 18px 'Inter', 'Segoe UI', Arial, sans-serif; fill: #1f2a44; }
    .label { font: 600 15px 'Inter', 'Segoe UI', Arial, sans-serif; fill: #1f2a44; }
    .text { font: 14px 'Inter', 'Segoe UI', Arial, sans-serif; fill: #2f3b52; }
    .small { font: 13px 'Inter', 'Segoe UI', Arial, sans-serif; fill: #2f3b52; }
    .line { stroke: #4b6cb7; stroke-width: 2; }
    .note { font: 13px 'Inter', 'Segoe UI', Arial, sans-serif; fill: #1f5080; }
  </style>

  <rect class="box" x="60" y="30" width="880" height="90" />
  <text class="title" x="80" y="60">Persona document</text>
  <text class="text" x="80" y="85">Object with required persona array (minItems 1) and additionalProperties disabled.</text>
  <text class="note" x="80" y="108">Validation injects allowed tool/skill enums from loaded catalogs.</text>

  <rect class="box" x="60" y="150" width="340" height="230" />
  <text class="title" x="80" y="175">persona[] entry</text>
  <text class="label" x="80" y="200">Required</text>
  <text class="text" x="80" y="220">name (string, minLength 1)</text>
  <text class="text" x="80" y="240">content (object)</text>
  <text class="label" x="80" y="270">Optional (schema allows extras)</text>
  <text class="text" x="80" y="290">meaning (string)</text>
  <text class="text" x="80" y="310">type.personal_assistant</text>
  <text class="text" x="80" y="330">allowed_tools[]</text>
  <text class="text" x="80" y="350">allowed_skills[]</text>
  <text class="text" x="80" y="370">collaboration</text>

  <rect class="subbox" x="430" y="150" width="240" height="170" />
  <text class="label" x="450" y="175">content</text>
  <text class="text" x="450" y="200">start_locked (string)</text>
  <text class="text" x="450" y="225">editable_content (string)</text>
  <text class="text" x="450" y="250">end_locked (string)</text>
  <text class="note" x="450" y="280">All three required; extras allowed.</text>

  <rect class="subbox" x="700" y="150" width="240" height="160" />
  <text class="label" x="720" y="175">type.personal_assistant</text>
  <text class="text" x="720" y="200">access_to_calendar</text>
  <text class="text" x="720" y="220">calendar_write_enabled</text>
  <text class="text" x="720" y="240">terminal_read_enabled</text>
  <text class="text" x="720" y="260">terminal_write_enabled</text>
  <text class="small" x="720" y="285">Each accepts boolean or string variant.</text>

  <rect class="subbox" x="430" y="350" width="240" height="130" />
  <text class="label" x="450" y="375">allowed_tools</text>
  <text class="text" x="450" y="400">Array of unique strings.</text>
  <text class="text" x="450" y="420">Enum injected from tool map.</text>
  <text class="note" x="450" y="445">Missing/null → no enabled tools.</text>

  <rect class="subbox" x="700" y="330" width="240" height="110" />
  <text class="label" x="720" y="355">allowed_skills</text>
  <text class="text" x="720" y="380">Array of unique strings.</text>
  <text class="text" x="720" y="400">Enum injected from skills.</text>

  <rect class="box" x="60" y="420" width="880" height="160" />
  <text class="title" x="80" y="445">collaboration</text>
  <text class="text" x="80" y="470">enabled (boolean|string), protocol (vote|critique|contract_net, default vote), quorum 0–1 (default 0.5), timeout ≥0 (default 10s).</text>
  <rect class="subbox" x="80" y="490" width="840" height="80" />
  <text class="label" x="100" y="515">participants[] entries</text>
  <text class="text" x="100" y="540">Required id (string, minLength 1); optional provider, model, system_prompt, weight (number), metadata (object); additionalProperties disallowed.</text>

  <line class="line" x1="230" y1="120" x2="230" y2="150" />
  <line class="line" x1="230" y1="380" x2="230" y2="420" />
  <line class="line" x1="400" y1="265" x2="430" y2="265" />
  <line class="line" x1="670" y1="230" x2="700" y2="230" />
  <line class="line" x1="400" y1="415" x2="430" y2="415" />
  <line class="line" x1="670" y1="385" x2="700" y2="385" />
