DEFAULT_STT_PROVIDER: whisper
DEFAULT_TTS_PROVIDER: eleven_labs
TTS_ENABLED: false
ACTIVE_USER: null
tools:
  javascript_executor:
    default_timeout: 5.0
    cpu_time_limit: 2.0
    memory_limit_bytes: 268435456
    max_output_bytes: 65536
    max_file_bytes: 131072
    max_files: 32

# RAG (Retrieval-Augmented Generation) configuration
rag:
  embeddings:
    # Default embedding provider: openai, cohere, or huggingface
    default_provider: huggingface

    openai:
      # API key loaded from OPENAI_API_KEY env var if not set here
      model: text-embedding-3-small
      dimensions: null  # null uses model default; set to reduce dimensions
      batch_size: 100
      max_retries: 3
      timeout: 60.0

    cohere:
      # API key loaded from COHERE_API_KEY or CO_API_KEY env var
      model: embed-english-v3.0
      batch_size: 96
      max_retries: 3
      timeout: 60.0
      truncate: END

    huggingface:
      model: all-MiniLM-L6-v2
      device: null  # null = auto-detect (cuda/mps/cpu)
      normalize_embeddings: true
      batch_size: 32
      trust_remote_code: false

  chunking:
    default_splitter: recursive  # recursive, sentence, or semantic
    chunk_size: 512
    chunk_overlap: 50
    preserve_metadata: true
    recursive_separators:
      - "\n\n"
      - "\n"
      - ". "
      - " "
      - ""
    sentence_min_length: 20

    # Hierarchical chunking - creates parent-child chunk relationships
    hierarchical_chunking_enabled: false
    parent_chunk_size: 2048  # Size of parent chunks in tokens
    child_chunk_size: 512  # Size of child chunks in tokens

  retrieval:
    enabled: true
    top_k: 10
    similarity_threshold: 0.7
    max_context_chunks: 5
    include_metadata: true
    default_knowledge_base_ids: []

  reranking:
    enabled: false
    provider: cross_encoder  # cross_encoder or cohere
    top_n_rerank: 20
    model: cross-encoder/ms-marco-MiniLM-L-6-v2
    cohere_model: rerank-english-v3.0
    hybrid_search_enabled: false
    hybrid_search_weight: 0.5  # 0 = all keyword, 1 = all vector

  caching:
    # Embedding cache - stores computed embeddings to avoid recomputation
    embedding_cache_enabled: true
    embedding_cache_max_size: 10000  # Max number of cached embeddings
    embedding_cache_ttl_seconds: 3600  # 1 hour TTL

    # Query result cache - stores full retrieval results
    query_cache_enabled: true
    query_cache_max_size: 1000  # Max cached query results
    query_cache_ttl_seconds: 300  # 5 minute TTL
    query_cache_semantic_matching: true  # Match semantically similar queries
    query_cache_similarity_threshold: 0.95  # Similarity threshold for matching
  compression:
    # Context compression to reduce token usage while preserving relevance
    enabled: false  # Enable context compression
    strategy: "extractive"  # Options: none, extractive, llmlingua, hybrid
    target_ratio: 0.5  # Target compression ratio (0.0-1.0, lower = more compression)
    min_context_length: 1000  # Only compress contexts longer than this

    # LLMLingua-specific settings (requires transformers)
    llmlingua_model: "gpt2"  # Model for perplexity scoring
    llmlingua_force_tokens: []  # Tokens to always preserve
    llmlingua_force_reserve_digit: true  # Preserve digit tokens

    # Extractive-specific settings
    extractive_preserve_first_sentence: true  # Always keep first sentence
    extractive_preserve_last_sentence: false  # Optionally keep last sentence
    extractive_min_sentences: 3  # Minimum sentences to retain

# Budget Manager configuration
budget:
  # Enable/disable budget tracking globally
  enabled: true

  # Interval (seconds) between flushing usage records to database
  flush_interval: 300

  # Cache TTL (seconds) for spend summaries
  cache_ttl: 60

  # Default budget limit for new users (USD)
  default_limit: 100.00

  # Percentage at which soft limit warnings trigger
  soft_limit_percent: 80

  # Default action when limit is exceeded: warn, block, throttle, notify
  default_action: warn

  # Alert configuration
  alerts:
    enabled: true
    # Cooldown (minutes) between repeated alerts for same policy
    cooldown_minutes: 60
    # Channels for alert delivery: ui, log, email, webhook
    default_channels:
      - ui
      - log

# Pre-configured budget policies (loaded at startup)
budget_policies: []
  # Example policy:
  # - name: "Global Monthly Budget"
  #   scope: global
  #   period: monthly
  #   limit_amount: 500.00
  #   soft_limit_percent: 80
  #   action: warn

# Calendar configuration - Multi-calendar support
calendars:
  # Default calendar for write operations when none specified
  default_calendar: null  # e.g., "personal"

  # Query all backends in parallel for better performance
  parallel_queries: true

  # Timeout (seconds) for backend queries
  query_timeout: 30.0

  # Merge duplicate events appearing in multiple calendars
  merge_duplicates: false

  # Calendar sources - each entry is a named calendar
  sources: {}
    # Example configurations:
    #
    # personal:
    #   type: ics
    #   path: ~/.local/share/calendars/personal.ics
    #   write_enabled: true
    #   sync_mode: on-demand  # realtime | on-demand | read-only | daily | manual
    #   color: "#4285f4"
    #   display_name: "Personal Calendar"
    #
    # work:
    #   type: google
    #   account: user@company.com
    #   calendar_id: primary
    #   write_enabled: true
    #   sync_mode: realtime
    #   color: "#ea4335"
    #   display_name: "Work Calendar"
    #
    # family:
    #   type: caldav
    #   url: https://nextcloud.example.com/remote.php/dav/calendars/user/family
    #   username: user
    #   password_key: nextcloud_calendar_password  # Key in secrets store
    #   write_enabled: true
    #   sync_mode: on-demand
    #   color: "#34a853"
    #
    # holidays:
    #   type: ics
    #   url: https://calendar.google.com/calendar/ical/en.usa%23holiday%40group.v.calendar.google.com/public/basic.ics
    #   write_enabled: false
    #   sync_mode: daily
    #   color: "#fbbc04"
    #   display_name: "US Holidays"

# Master Calendar settings - internal calendar database
calendar:
  # Enable master calendar feature
  enabled: true

  # Database backend: postgresql | sqlite
  database: postgresql

  # Default settings
  default_category: personal
  default_reminder_minutes: 15
  default_view: month  # month | week | day | agenda

  # Work hours (for busy/free detection)
  work_hours:
    start: "09:00"
    end: "17:00"
    days: [1, 2, 3, 4, 5]  # Monday=1 through Friday=5
    timezone: null  # null uses system timezone

  # Sync settings for external calendar sources
  sync:
    auto_sync: true
    sync_interval_minutes: 15
    conflict_resolution: ask  # ask | local_wins | remote_wins | newest_wins

  # Holidays auto-population
  holidays:
    enabled: true
    country: US
    regions: []  # Optional: state-specific holidays
